<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Portal xAsset Bridge - Wormhole xDapp Development Book v0.1.0</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction/introduction.html">Introduction</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Overview</li><li class="chapter-item expanded "><a href="../dapps/0_xdappOverview.html"><strong aria-hidden="true">1.</strong> xDapps</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../dapps/1_defiBasics.html"><strong aria-hidden="true">1.1.</strong> Dapp Ecosystem Basics</a></li><li class="chapter-item expanded "><a href="../dapps/2_crossChainInteroperability.html"><strong aria-hidden="true">1.2.</strong> Cross-Chain Interoperability</a></li><li class="chapter-item expanded "><a href="../dapps/3_xdataxassets.html"><strong aria-hidden="true">1.3.</strong> xData &amp; xAssets</a></li><li class="chapter-item expanded "><a href="../dapps/4_whatIsanXdapp.html"><strong aria-hidden="true">1.4.</strong> What is an xDapp?</a></li><li class="chapter-item expanded "><a href="../dapps/5_advantages.html"><strong aria-hidden="true">1.5.</strong> Advantages of xDapps</a></li></ol></li><li class="chapter-item expanded "><a href="../wormhole/0_wormholeOverview.html"><strong aria-hidden="true">2.</strong> Wormhole</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../wormhole/1_whatIsWormhole.html"><strong aria-hidden="true">2.1.</strong> What is Wormhole?</a></li><li class="chapter-item expanded "><a href="../wormhole/2_architectureOverview.html"><strong aria-hidden="true">2.2.</strong> Architecture Overview</a></li><li class="chapter-item expanded "><a href="../wormhole/3_coreLayerContracts.html"><strong aria-hidden="true">2.3.</strong> Core Layer Contracts</a></li><li class="chapter-item expanded "><a href="../wormhole/4_vaa.html"><strong aria-hidden="true">2.4.</strong> VAA: Verified Action Approval</a></li><li class="chapter-item expanded "><a href="../wormhole/5_guardianNetwork.html"><strong aria-hidden="true">2.5.</strong> Guardian Network</a></li><li class="chapter-item expanded "><a href="../wormhole/6_relayers.html"><strong aria-hidden="true">2.6.</strong> Relayers</a></li><li class="chapter-item expanded "><a href="../wormhole/7_portalTokenBridge.html" class="active"><strong aria-hidden="true">2.7.</strong> Portal xAsset Bridge</a></li><li class="chapter-item expanded "><a href="../wormhole/8_wormchain.html"><strong aria-hidden="true">2.8.</strong> Wormchain</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">xDapp Architecture</li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> xDapp Design</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.1.</strong> Key Considerations</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Ecosystems</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.1.</strong> EVM</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.2.</strong> Solana</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.3.</strong> Cosmos</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.4.</strong> Algorand</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.</strong> Protocol-First Design</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> Topology</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.1.</strong> Hub &amp; Spoke</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.2.</strong> Mesh</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> xAssets</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.</strong> Relayers</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.1.</strong> Generic Relayers</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.2.</strong> Protocol-Specific Relayers</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.7.</strong> Security</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.7.1.</strong> Trust Assumptions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.7.2.</strong> Layer 1 Risk</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.7.3.</strong> Finality Guarantees</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.8.</strong> Examples</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.8.1.</strong> Cross-Chain Dex</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.8.2.</strong> Remote Staking</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.9.</strong> Common Use Cases</div></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">xDapp Development</li><li class="chapter-item expanded "><a href="../development/overview.html"><strong aria-hidden="true">4.</strong> Before You Start</a></li><li class="chapter-item expanded "><a href="../development/wormhole-local-validator.html"><strong aria-hidden="true">5.</strong> Wormhole Local Validator</a></li><li class="chapter-item expanded "><a href="../development/tilt/overview.html"><strong aria-hidden="true">6.</strong> Tilt Installation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../development/tilt/mac.html"><strong aria-hidden="true">6.1.</strong> MacOS</a></li><li class="chapter-item expanded "><a href="../development/tilt/linux.html"><strong aria-hidden="true">6.2.</strong> Linux</a></li><li class="chapter-item expanded "><a href="../development/tilt/constants.html"><strong aria-hidden="true">6.3.</strong> Constants</a></li></ol></li><li class="chapter-item expanded "><a href="../development/scaffold/overview.html"><strong aria-hidden="true">7.</strong> Project Scaffold</a></li><li class="chapter-item expanded "><a href="../development/messages/sending/overview.html"><strong aria-hidden="true">8.</strong> Sending Messages</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../development/messages/sending/evm.html"><strong aria-hidden="true">8.1.</strong> EVM</a></li></ol></li><li class="chapter-item expanded "><a href="../development/messages/registration/overview.html"><strong aria-hidden="true">9.</strong> Registering xDapps</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../development/messages/registration/evm.html"><strong aria-hidden="true">9.1.</strong> EVM</a></li></ol></li><li class="chapter-item expanded "><a href="../development/messages/relaying/overview.html"><strong aria-hidden="true">10.</strong> Relaying Messages</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">10.1.</strong> Manual Relays</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.2.</strong> REST &amp; Spy Relayer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.3.</strong> Generic Relayers</div></li></ol></li><li class="chapter-item expanded "><a href="../development/messages/receiving/overview.html"><strong aria-hidden="true">11.</strong> Receving Messages</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../development/messages/receiving/evm.html"><strong aria-hidden="true">11.1.</strong> EVM</a></li></ol></li><li class="chapter-item expanded "><a href="../projects/summary.html"><strong aria-hidden="true">12.</strong> Projects</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../projects/evm-messenger/overview.html"><strong aria-hidden="true">12.1.</strong> EVM Messenger</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../projects/evm-messenger/messenger.html"><strong aria-hidden="true">12.1.1.</strong> Solidity</a></li><li class="chapter-item expanded "><a href="../projects/evm-messenger/client.html"><strong aria-hidden="true">12.1.2.</strong> JS Client</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><li class="part-title">Portal Token Bridge</li><li class="chapter-item expanded "><a href="../development/portal/overview.html"><strong aria-hidden="true">13.</strong> Portal</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">13.1.</strong> EVM</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../development/portal/evm/attestingToken.html"><strong aria-hidden="true">13.1.1.</strong> Attesting</a></li><li class="chapter-item expanded "><a href="../development/portal/evm/tokenTransfer.html"><strong aria-hidden="true">13.1.2.</strong> Transfer Tokens</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.2.</strong> Portal JS Client Transfers</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">13.2.1.</strong> EVM to Solana Transfer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.2.2.</strong> Polygon to Oasis with Relayers</div></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">14.</strong> Portal Payloads</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Other Resources</li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> Reference</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/tools.html"><strong aria-hidden="true">15.1.</strong> Tools</a></li><li class="chapter-item expanded "><a href="../reference/github.html"><strong aria-hidden="true">15.2.</strong> Github &amp; Useful Links</a></li><li class="chapter-item expanded "><a href="../reference/contracts.html"><strong aria-hidden="true">15.3.</strong> Deployed Contracts</a></li><li class="chapter-item expanded "><a href="../reference/rpcnodes.html"><strong aria-hidden="true">15.4.</strong> RPC Nodes</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Wormhole xDapp Development Book v0.1.0</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/certusone/xdapp-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="portal"><a class="header" href="#portal">Portal</a></h1>
<p>Portal is a set of ecosystem contracts which provision Wormhole's xAsset layer. These contracts allow tokens to be bridged around the Wormhole Ecosystem in a <strong>path-independent</strong> fashion, and in a manner easily composeable with other functions in the Wormhole ecosystem, such as Core-Layer messaging.</p>
<p>The Portal functions are a major focus of the <a href="https://www.npmjs.com/package/@certusone/wormhole-sdk">Wormhole Typescript SDK</a>. If you're looking to interact with Portal directly from a typescript client or backend, you should start there. This section will only provide a high-level overview of how to interact with the Portal contracts. If you'd prefer to look at code examples, they are provided in the <strong>Portal Examples</strong> section.</p>
<h2 id="creating-xassets"><a class="header" href="#creating-xassets">Creating xAssets</a></h2>
<p>xAssets always have an <strong>origin chain</strong>. This is the chain where the token is initially minted, via the standard of that chain (ERC-20, SPL, etc).</p>
<p>To begin converting this asset into an xAsset, an <strong>attestation</strong> must first be created. This is accomplished by simply calling the <strong>attest</strong> function on the Portal contract of the origin chain.</p>
<pre><code>function attestToken(
    address tokenAddress,
    uint32 nonce)
 returns (uint64 sequence)
</code></pre>
<p>The Guardian Network will then produce an <strong>attestation VAA</strong>, which can be retrieved using the sequence number returned by the attestToken function.</p>
<p>The attestation VAA must then be submitted to the <strong>createWrapped</strong> function of every other chain, referred to as <strong>foreign chains</strong> for this token.</p>
<pre><code>function createWrapped(
    bytes memory encodedVm)
returns (address token)
</code></pre>
<p>Calling this function will deploy a new contract for the token on the foreign chain, creating a <strong>Wormhole-Wrapped Token</strong>. The wrapped token will use the same symbol as the origin asset, and will append (Wormhole) to the end of the name.</p>
<p>These assets are all <strong>fungible</strong> with eachother. This means the wrapped token from any chain can be exchanged for the original token or any of the wrapped tokens from other chains.</p>
<h2 id="transferring-assets"><a class="header" href="#transferring-assets">Transferring Assets</a></h2>
<pre><code>function transferTokens(
    address token,
    uint256 amount,
    uint16 recipientChain,
    bytes32 recipient,
    uint256 arbiterFee,
    uint32 nonce) returns (uint64 sequence)
</code></pre>
<p>Initiating a token transfer is a relatively straightforward affair. After the transfer is initiated, the Guardians will produce a transfer VAA once finality has been reached on the <strong>source chain</strong>. The VAA must then be relayed to the <strong>target chain</strong>.</p>
<p>All tokens managed by Portal are backed by the origin asset, and this allows for the tokens to be transferred in a path-independent fashion. Regardless of what chain the tokens are passed to, a 'double-wrapped' asset will never be created for a single backing asset. Additionally, because Portal is based purely on a wrapping model, there are no liquidity limitations.</p>
<h2 id="contract-controlled-transfers"><a class="header" href="#contract-controlled-transfers">Contract-Controlled Transfers</a></h2>
<p>Contract Controlled Transfers (CCTs) are a feature designed to allow xDapp contracts to easily perform Portal transfers. Contract controlled transfers are quite similar to simple transfers, but have two additional features:</p>
<ul>
<li>An arbitrary byte array can be appended to the transfer, which can be used to easily pass additional information to the recipient contract.</li>
<li>The CCT VAA redeem can only be performed by the recipient contract, as opposed to basic transfers, which can be performed by any caller. This ensures that any additional operations which the contract wants to perform as part of the redeem transaction must be executed.</li>
</ul>
<p>In short, basic transfers are intended to transfer tokens from one wallet to another, whereas CCTs are meant to transfer tokens from one smart contract to another. If you're writing an xDapp, you probably want to use CCTs for the most part.</p>
<p>In the next section. We'll discuss Wormchain, and some of the upcoming features it will enable.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../wormhole/6_relayers.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../wormhole/8_wormchain.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../wormhole/6_relayers.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../wormhole/8_wormchain.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
